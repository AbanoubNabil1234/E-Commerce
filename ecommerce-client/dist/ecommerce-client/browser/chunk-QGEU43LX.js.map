{
  "version": 3,
  "sources": ["src/app/features/categories/services/category.service.ts"],
  "sourcesContent": ["import { Injectable, inject } from '@angular/core';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\nimport { Observable, switchMap, tap } from 'rxjs';\r\nimport { environment } from '../../../../environments/environment';\r\nimport { LanguageService } from '../../../core/services/language.service';\r\nimport { NotificationService } from '../../../core/services/notification.service';\r\n\r\nexport interface Category {\r\n    id: number;\r\n    parentId?: number;\r\n    parentName?: string;\r\n    level?: number;\r\n    name: string;\r\n    slug: string;\r\n    description?: string;\r\n    imageUrl?: string;\r\n    displayOrder: number;\r\n    languageCode: string;\r\n    isActive: boolean;\r\n    productsCount?: number;\r\n    createdAt?: Date;\r\n}\r\n\r\nexport interface CategoryListResponse {\r\n    items: Category[];\r\n    totalCount: number;\r\n    pageNumber: number;\r\n    pageSize: number;\r\n    totalPages: number;\r\n    hasPreviousPage: boolean;\r\n    hasNextPage: boolean;\r\n}\r\n\r\nexport interface CreateCategoryRequest {\r\n    parentId?: number;\r\n    name: string;\r\n    slug: string;\r\n    description?: string;\r\n    imageUrl?: string;\r\n    displayOrder: number;\r\n    translations: CategoryTranslation[];\r\n}\r\n\r\nexport interface UpdateCategoryRequest {\r\n    id: number;\r\n    parentId?: number;\r\n    name: string;\r\n    slug: string;\r\n    description?: string;\r\n    imageUrl?: string;\r\n    displayOrder: number;\r\n    isActive: boolean;\r\n    translations: CategoryTranslation[];\r\n}\r\n\r\nexport interface CategoryTranslation {\r\n    id?: number;\r\n    languageCode: string;\r\n    name: string;\r\n    description?: string;\r\n    slug?: string;\r\n}\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class CategoryService {\r\n    private readonly baseUrl = `${environment.apiUrl}/categories`;\r\n    private toast = inject(NotificationService);\r\n\r\n    constructor(\r\n        private http: HttpClient,\r\n        private languageService: LanguageService\r\n    ) { }\r\n\r\n    /**\r\n     * Get parent options for dropdown\r\n     */\r\n    getDropdown(): Observable<Category[]> {\r\n        return this.http.get<Category[]>(`${this.baseUrl}/dropdown`);\r\n    }\r\n\r\n    getPaged(\r\n        pageNumber: number = 1,\r\n        pageSize: number = 10,\r\n        search?: string,\r\n        isActive?: boolean\r\n    ): Observable<CategoryListResponse> {\r\n        let params = new HttpParams()\r\n            .set('pageNumber', pageNumber.toString())\r\n            .set('pageSize', pageSize.toString());\r\n\r\n        if (search) {\r\n            params = params.set('search', search);\r\n        }\r\n\r\n        if (isActive !== undefined && isActive !== null) {\r\n            params = params.set('isActive', isActive.toString());\r\n        }\r\n\r\n        return this.http.get<CategoryListResponse>(`${this.baseUrl}/paged`, { params });\r\n    }\r\n\r\n    getById(id: number): Observable<Category> {\r\n        return this.http.get<Category>(`${this.baseUrl}/${id}`);\r\n    }\r\n\r\n    create(request: CreateCategoryRequest): Observable<Category> {\r\n        return this.http.post<Category>(this.baseUrl, request).pipe(\r\n            tap(cat => this.toast.success(`Category \"${cat.name}\" created successfully`, { title: 'üìÇ Category Created' }))\r\n        );\r\n    }\r\n\r\n    update(id: number, request: UpdateCategoryRequest): Observable<Category> {\r\n        return this.http.put<Category>(`${this.baseUrl}/${id}`, request).pipe(\r\n            tap(() => this.toast.success('Category updated successfully', { title: '‚úÖ Category Updated' }))\r\n        );\r\n    }\r\n\r\n    delete(id: number): Observable<void> {\r\n        return this.http.delete<void>(`${this.baseUrl}/${id}`).pipe(\r\n            tap(() => this.toast.warning('Category deleted', { title: 'üóëÔ∏è Category Deleted' }))\r\n        );\r\n    }\r\n\r\n    toggleStatus(category: Category): Observable<Category> {\r\n        const request: UpdateCategoryRequest = {\r\n            id: category.id,\r\n            parentId: category.parentId,\r\n            name: category.name,\r\n            slug: category.slug,\r\n            description: category.description,\r\n            imageUrl: category.imageUrl,\r\n            displayOrder: category.displayOrder,\r\n            isActive: !category.isActive, // Toggle\r\n            translations: [] // Usually we fetch full category first or backend handles partial update? \r\n            // The backend UpdateCategoryCommand replaces translations if provided.\r\n            // If we send empty list, loop in backend does nothing?\r\n            // Review CategoryService.cs (Backend): \"Update translations: foreach...\"\r\n            // If list is empty, it does nothing. Existing translations remain?\r\n            // Ah, if I want to KEEP existing translations, I should send them?\r\n            // Or `UpdateCategoryCommand` logic: \"foreach (var translationDto in dto.Translations)\"\r\n            // It UPDATES existing ones. It does NOT delete missing ones. \r\n            // So sending empty list is SAFE for status toggle.\r\n        };\r\n        return this.update(category.id, request);\r\n    }\r\n\r\n    getPagedWithLanguageReload(\r\n        pageNumber: number = 1,\r\n        pageSize: number = 10,\r\n        search?: string,\r\n        isActive?: boolean\r\n    ): Observable<CategoryListResponse> {\r\n        return this.languageService.currentLanguage$.pipe(\r\n            switchMap(() => this.getPaged(pageNumber, pageSize, search, isActive))\r\n        );\r\n    }\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;AAkEM,IAAO,kBAAP,MAAO,iBAAe;EAKZ;EACA;EALK,UAAU,GAAG,YAAY,MAAM;EACxC,QAAQ,OAAO,mBAAmB;EAE1C,YACY,MACA,iBAAgC;AADhC,SAAA,OAAA;AACA,SAAA,kBAAA;EACR;;;;EAKJ,cAAW;AACP,WAAO,KAAK,KAAK,IAAgB,GAAG,KAAK,OAAO,WAAW;EAC/D;EAEA,SACI,aAAqB,GACrB,WAAmB,IACnB,QACA,UAAkB;AAElB,QAAI,SAAS,IAAI,WAAU,EACtB,IAAI,cAAc,WAAW,SAAQ,CAAE,EACvC,IAAI,YAAY,SAAS,SAAQ,CAAE;AAExC,QAAI,QAAQ;AACR,eAAS,OAAO,IAAI,UAAU,MAAM;IACxC;AAEA,QAAI,aAAa,UAAa,aAAa,MAAM;AAC7C,eAAS,OAAO,IAAI,YAAY,SAAS,SAAQ,CAAE;IACvD;AAEA,WAAO,KAAK,KAAK,IAA0B,GAAG,KAAK,OAAO,UAAU,EAAE,OAAM,CAAE;EAClF;EAEA,QAAQ,IAAU;AACd,WAAO,KAAK,KAAK,IAAc,GAAG,KAAK,OAAO,IAAI,EAAE,EAAE;EAC1D;EAEA,OAAO,SAA8B;AACjC,WAAO,KAAK,KAAK,KAAe,KAAK,SAAS,OAAO,EAAE,KACnD,IAAI,SAAO,KAAK,MAAM,QAAQ,aAAa,IAAI,IAAI,0BAA0B,EAAE,OAAO,6BAAqB,CAAE,CAAC,CAAC;EAEvH;EAEA,OAAO,IAAY,SAA8B;AAC7C,WAAO,KAAK,KAAK,IAAc,GAAG,KAAK,OAAO,IAAI,EAAE,IAAI,OAAO,EAAE,KAC7D,IAAI,MAAM,KAAK,MAAM,QAAQ,iCAAiC,EAAE,OAAO,0BAAoB,CAAE,CAAC,CAAC;EAEvG;EAEA,OAAO,IAAU;AACb,WAAO,KAAK,KAAK,OAAa,GAAG,KAAK,OAAO,IAAI,EAAE,EAAE,EAAE,KACnD,IAAI,MAAM,KAAK,MAAM,QAAQ,oBAAoB,EAAE,OAAO,mCAAsB,CAAE,CAAC,CAAC;EAE5F;EAEA,aAAa,UAAkB;AAC3B,UAAM,UAAiC;MACnC,IAAI,SAAS;MACb,UAAU,SAAS;MACnB,MAAM,SAAS;MACf,MAAM,SAAS;MACf,aAAa,SAAS;MACtB,UAAU,SAAS;MACnB,cAAc,SAAS;MACvB,UAAU,CAAC,SAAS;;MACpB,cAAc,CAAA;;;;;;;;;;;AAUlB,WAAO,KAAK,OAAO,SAAS,IAAI,OAAO;EAC3C;EAEA,2BACI,aAAqB,GACrB,WAAmB,IACnB,QACA,UAAkB;AAElB,WAAO,KAAK,gBAAgB,iBAAiB,KACzC,UAAU,MAAM,KAAK,SAAS,YAAY,UAAU,QAAQ,QAAQ,CAAC,CAAC;EAE9E;;qCA3FS,kBAAe,mBAAA,UAAA,GAAA,mBAAA,eAAA,CAAA;EAAA;4EAAf,kBAAe,SAAf,iBAAe,WAAA,YAFZ,OAAM,CAAA;;",
  "names": []
}
